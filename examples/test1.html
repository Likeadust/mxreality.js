<!DOCTYPE html>
<html lang="en">

<head>
    <title>测试</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <style>
    </style>

</head>

<body>
    <video controls='true' src="http://ivi.bupt.edu.cn/hls/cctv5phd.m3u8" id="video"></video>
    <div id="container" style="width: 500px;height:500px;"></div>

    <script src="../build/three.js"></script>
    <script src="../build/mxreality.js?id=cc"></script>
    <script>

        window.onload = function () {
            init();//初始化
        }
        function init() {

            /*var video = AVR.createTag('video', {
                'webkit-playsinline': true,
                'playsinline': true,
                'preload': 'auto',
                'x-webkit-airplay': 'allow',
                //'x5-playsinline': true,
                'x5-video-player-type': 'h5',
                'x5-video-player-fullscreen': true,
                'x5-video-orientation': 'portrait',
                'style': 'object-fit: fill',
                'loop': "loop",
                'controls': true
            }, {
                'allowsInlineMediaPlayback': true,
                'crossOrigin': "Anonymous"
            });
            document.body.appendChild(video);
            video.src = 'http://ivi.bupt.edu.cn/hls/cctv5phd.m3u8';*/
            var video=document.getElementById('video');
            //video.src='360.mp4';
            video.addEventListener('loadedmetadata', function () {
                video.play();
            });
            

            document.body.addEventListener('click', function () {
                video.play();
            })

            var scene, renderer;
            var container, mesh;
            container = document.getElementById('container');
            renderer = new THREE.WebGLRenderer();
            scene = new THREE.Scene();
            renderer.setPixelRatio(window.devicePixelRatio);
            renderer.setSize(container.offsetWidth, container.offsetHeight);
            container.appendChild(renderer.domElement);

            var camera = new THREE.PerspectiveCamera(80, container.innerWidth / container.innerHeight, 0.01, 1000);
            //camera.lookAt({ 'x': 0, 'y': 0, 'z': 0 });

            camera.position.set(0, 0, 0.01);
            scene.add(camera);

            var texture = new THREE.VideoTexture(video);
            //texture.generateMipmaps = false;
            //texture.minFilter = THREE.LinearFilter;
            //texture.magFilter = THREE.LinearFilter;
            //texture.format = THREE.RGBFormat;
            //texture.format = THREE.RGBAFormat;
            material = new THREE.MeshBasicMaterial({
                //overdraw: true,
                map: texture,
                side: 2,
                //color: 0xababab
            });
            var phiStart = -Math.PI / 2;
            var geometry = new THREE.SphereBufferGeometry(10, 10, 10, phiStart);
            //geometry.scale(-1, 1, 1); //x取反（面朝里）
            mesh = new THREE.Mesh(geometry, material);
            mesh.visible = true;
            mesh.name = "__mxrealityDefault";

            scene.add(mesh);


            function render() {
                var width = container.offsetWidth;
                var height = container.offsetHeight;
                camera.aspect = width / height;
                renderer.setSize(width, height);
                renderer.setClearColor(new THREE.Color(0x000000));
                renderer.render(scene, camera);
                camera.updateProjectionMatrix();
            }
            function animate() {
                render();
                requestAnimationFrame(animate);
            }
            animate();
        }

    </script>

</body>

</html>